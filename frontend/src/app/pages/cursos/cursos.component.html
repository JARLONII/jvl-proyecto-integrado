<!-- Consultar la tabla -->
<div class="mb-3">
  <label for="filtroColumna" class="form-label">Filtrar por:</label>
  <div class="input-group">
    <select [(ngModel)]="filtroColumna" id="filtroColumna" class="form-select">
      <option value="id">ID</option>
      <option value="nombre">Nombre</option>
      <option value="apellidos">Apellidos</option>
      <option value="email">Email</option>
      <option value="telefono">Telรฉfono</option>
      <option value="fecha_nac">Fecha de nacimiento</option>
      <option value="direccion">Direcciรณn</option>
    </select>
    <input [(ngModel)]="filtroValor"
      (keyup.enter)="filtrar()"
      class="form-control"
      placeholder="Ej: 1,2,3" />
    <button class="btn btn-primary" (click)="filtrar()">Buscar</button>
    <button class="btn btn-secondary" (click)="verTodos()">Quitar filtro</button>
  </div>
</div>

<!-- Importar cursos -->
<div *ngIf="rolUsuario === 'administrador'" class="mt-4">
  <form (submit)="importar()">
    <input type="file" (change)="onArchivoSeleccionado($event)" accept=".json" required>
    <button type="submit">Importar Cursos</button>
  </form>
  <br>
</div>

<!-- Tabla -->
<table>
  <thead>
    <tr>
      <th (click)="ordenarPor('id')">ID
        <span *ngIf="columnaOrden === 'id'">{{ ordenAscendente ? 'โฒ' : 'โผ' }}</span></th>
      <th (click)="ordenarPor('nombre')">Nombre
        <span *ngIf="columnaOrden === 'nombre'">{{ ordenAscendente ? 'โฒ' : 'โผ' }}</span></th>
      <th (click)="ordenarPor('nivel')">Nivel
        <span *ngIf="columnaOrden === 'nivel'">{{ ordenAscendente ? 'โฒ' : 'โผ' }}</span></th>
      <th (click)="ordenarPor('anio_academico')">Aรฑo Acadรฉmico
        <span *ngIf="columnaOrden === 'anio_academico'">{{ ordenAscendente ? 'โฒ' : 'โผ' }}</span></th>
      <th (click)="ordenarPor('created_at')">Creado en
        <span *ngIf="columnaOrden === 'created_at'">{{ ordenAscendente ? 'โฒ' : 'โผ' }}</span></th>
      <th (click)="ordenarPor('updated_at')">Actualizado en
        <span *ngIf="columnaOrden === 'updated_at'">{{ ordenAscendente ? 'โฒ' : 'โผ' }}</span></th>
      <th *ngIf="rolUsuario === 'administrador'" colspan="2">
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let curso of cursos">
      <!-- ID -->
      <td>{{ curso.id }}</td>

      <!-- Nombre -->
      <td *ngIf="editandoId !== curso.id">{{ curso.nombre }}</td>
      <td *ngIf="editandoId === curso.id">
        <select [(ngModel)]="editando!.nombre" name="nombre" class="form-select form-select-sm">
          <option value="1ยบ E.S.O.">1ยบ E.S.O.</option>
          <option value="2ยบ E.S.O.">2ยบ E.S.O.</option>
          <option value="3ยบ E.S.O.">3ยบ E.S.O.</option>
          <option value="4ยบ E.S.O.">4ยบ E.S.O.</option>
          <option value="1ยบ Bachillerato Arte">1ยบ Bachillerato Arte</option>
          <option value="2ยบ Bachillerato Arte">2ยบ Bachillerato Arte</option>
          <option value="1ยบ Bachillerato Ciencias">1ยบ Bachillerato Ciencias</option>
          <option value="2ยบ Bachillerato Ciencias">2ยบ Bachillerato Ciencias</option>
          <option value="1ยบ Bachillerato Humanidades">1ยบ Bachillerato Humanidades</option>
          <option value="2ยบ Bachillerato Humanidades">2ยบ Bachillerato Humanidades</option>
          <option value="1ยบ APSD">1ยบ APSD</option>
          <option value="2ยบ APSD">2ยบ APSD</option>
          <option value="1ยบ SMR">1ยบ SMR</option>
          <option value="2ยบ SMR">2ยบ SMR</option>
          <option value="1ยบ ASIR">1ยบ ASIR</option>
          <option value="2ยบ ASIR">2ยบ ASIR</option>
          <option value="1ยบ DAM">1ยบ DAM</option>
          <option value="2ยบ DAM">2ยบ DAM</option>
          <option value="1ยบ Educacion Infantil">1ยบ Educacion Infantil</option>
          <option value="2ยบ Educacion Infantil">2ยบ Educacion Infantil</option>
          <option value="1ยบ Integraciรณn Social">1ยบ Integraciรณn Social</option>
          <option value="2ยบ Integraciรณn Social">2ยบ Integraciรณn Social</option>
        </select>
      </td>

      <!-- Nivel -->
      <td *ngIf="editandoId !== curso.id">{{ curso.nivel }}</td>
      <td *ngIf="editandoId === curso.id">
        <select [(ngModel)]="editando!.nivel" name="nivel" class="form-select form-select-sm">
          <option value="E.S.O.">E.S.O.</option>
          <option value="Bachillerato">Bachillerato</option>
          <option value="FP">FP</option>
        </select>
      </td>

      <!-- Aรฑo acadรฉmico -->
      <td *ngIf="editandoId !== curso.id">{{ curso.anio_academico }}</td>
      <td *ngIf="editandoId === curso.id">
        <input [(ngModel)]="editando!.anio_academico" name="anio_academico" class="form-control form-control-sm" required />
      </td>

      <!-- Fechas -->
      <td>{{ curso.created_at | date: 'short' }}</td>
      <td>{{ curso.updated_at | date: 'short' }}</td>

      <!-- Editar -->
      <td *ngIf="rolUsuario === 'administrador'">
        <button *ngIf="editandoId !== curso.id" class="btn btn-sm btn-outline-secondary" (click)="editar(curso)">
          โ๏ธ
        </button>
        <div *ngIf="editandoId === curso.id" class="d-flex gap-1">
          <button class="btn btn-sm btn-success" (click)="guardarCambiosFila()">๐พ</button>
          <button class="btn btn-sm btn-danger" (click)="cancelarEdicionFila()">โ</button>
        </div>
      </td>
      <!-- Borrar -->
      <td *ngIf="rolUsuario === 'administrador'">
        <button class="btn btn-sm btn-outline-secondary" (click)="eliminar(curso.id)">
          ๐๏ธ
        </button>
      </td>
    </tr>
  </tbody>
</table>
